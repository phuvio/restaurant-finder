{% extends "layout.html" %}
{% block content %}

    {% if mymap %}

        {{"decoupled-map"|googlemap_js(37.4419, -122.1419)}} {{mymap.js}}

        {{ mymap.html }}

    {% endif %}
    
    {% for restaurant in restaurants %}
        <p><a href="/restaurant/{{ restaurant.id }}">{{ restaurant.name }}</a>
        {{ restaurant.avg_stars }} tähteä</p>
    {% endfor %}

    <h2>Hae ravintolaa hakusanalla</h2>

    <form action="/restaurants" method="post">
        Haettava teksti: 
        <br>
        <input type="text" name="search_string" minlength="1" maxlength="20">
        <p>
        <input type="submit" name="action" value="Hae">
        <input type="hidden" name="csrf_token" value="{{ session.csrf_token }}">
    </form>

    <h2>Hae ravintolaa ryhmästä</h2>

    <form action="/restaurants" method="post">
        <select name="select_group" method="post">
            <option value="">-- Valitse ryhmä --</option>
            {% for group in dropdown %}
                <option value="{{ group.id }}">{{ group.name }}</option>
            {% endfor %}
        </select>
        <input type="submit" name="action" value="Hae ryhmää">
        <input type="hidden" name="csrf_token" value="{{ session.csrf_token }}">
    </form>

    {% if found_restaurants %}
        <h2>Löydetyt ravintolat</h2>
        {% for found in found_restaurants %}
            <p>{{ found.avg_stars }} <a href="/restaurant/{{ found.id }}">{{ found.name }}</a></p>
        {% endfor %}
    {% endif %}

    {% if error %}
        <p>{{ error }}</p>
    {% endif %}

{% endblock %}